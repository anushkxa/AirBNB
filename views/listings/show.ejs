<%layout("/layouts/boilerplate.ejs")  %>
<body>
<div class="row">
    <div class="col-8 offset-2">

    <h3><%= listing.title %></h3>
    <div class="card">
        <img src="<%= listing.image && listing.image.url ? listing.image.url : '/images/listings/default.jpg' %>" class="card-img-top show-img" alt="listing_image">
        <div class="card-body">
            <p class="card-text">
                <%= listing.description %> </br>
                &#8377;<%=listing.price.toLocaleString("en-IN")%><br>
                <%= listing.location %> </li><br>
                <%= listing.country %> </li>
            </p>
        </div>
    </div>
    <div class="btn" style="display: flex;flex-direction: row; justify-content: space-around;">
    <a  href="/listings/<%=listing._id%>/edit" class="btn btn-danger">Edit</a>
    <form method="post" action="/listings/<%=listing._id%>?_method=DELETE">
        <button class="btn btn-dark">Delete</button>
    </form>
    </div>
    </div>
    <div class="col-8 offset-3 mb-3" style="justify-content: space-between;">
        <hr>
        <h4>Leave a Review</h4>
        <form action="/listings/<%=listing.id%>/reviews" 
            method="POST"
            novalidate 
            class="needs-validation">
            <div>
                <label for="rating" class="form-label">Rating</label>
                <input type="range" min="1" max="5" id="rating" name="review[rating]" class="form-range"/>
            </div>
            <div>
                <label for="comment"
                class="form-label">Comment</label>
            </div>
            <div>
                <textarea
                name="review[comment]"
                id="comment
                "cols="30"
                class="form-control"
                required
                rows="5"></textarea>
                <div class="invalid-feedback">
                    Please submit some comments for review
                </div>
            </div>
            <button class="btn btn-danger">Submit</button>
        </form>
        <hr>
        <h4>All Reviews</h4>
        <ul>
        <% for(review of listing.reviews) {%>
            <li><%= review.comment%>, <%=review.rating%> Stars</li>
        <% } %>
        </ul>
    </div>
</div>
